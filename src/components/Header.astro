---
import type { iconPaths } from './IconPaths';
import { Image } from 'astro:assets';
import LogoImage from '../images/Duisterethomas-Logo.png'
import Social from './Social.astro';

/** Main menu items */
const textLinks: { label: string; href: string }[] = [
	{ label: 'Home', href: '/' },
	{ label: 'Gear', href: '/gear' },
];

/** Icon links to social media */
const iconLinks: { label: string; href: string; icon: keyof typeof iconPaths; color: string }[] = [
	{ label: 'YouTube', href: 'https://www.youtube.com/@Duisterethomas/', icon: 'youtube-logo', color: '#FF0000' },
	{ label: 'SoundCloud', href: 'https://soundcloud.com/duisterethomas', icon: 'soundcloud-logo', color: '#FF5500' },
	{ label: 'Modrinth', href: 'https://www.modrinth.com/user/duisterethomas', icon: 'modrinth-logo', color: '#00AF5C' },
	{ label: 'GitHub', href: 'https://github.com/duisterethomas', icon: 'github-logo', color: '#FFFFFF' },
	{ label: 'Itch.io', href: 'https://duisterethomas.itch.io/', icon: 'itch.io-logo', color: '#FA5C5C' },
	{ label: 'Game Jolt', href: 'https://gamejolt.com/@duisterethomas', icon: 'gamejolt-logo', color: '#CCFF00' },
	{ label: 'Twitch', href: 'https://www.twitch.tv/duisterethomas', icon: 'twitch-logo', color: '#9146FF' },
	{ label: 'Reddit', href: 'https://www.reddit.com/r/duisterethomas/', icon: 'reddit-logo', color: '#FF4500' },
];

/** Test if a link is pointing to the current page. */
const isCurrentPage = (href: string) => {
	let pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
	if (pathname.at(0) !== '/') pathname = '/' + pathname;
	if (pathname.at(-1) !== '/') pathname += '/';
	return pathname === href || (href !== '/' && pathname.startsWith(href));
};
---

<header>
	<a href="/" class="site-logo">
		<Image src={LogoImage} alt="Duisterethomas" height="64" loading="eager" />
	</a>
	<nav class="nav-items backdrop-blur-xl">
		{
			textLinks.map(({ label, href }) => (
				<li>
					<a aria-current={isCurrentPage(href) ? 'page' : null} class="link" href={href}>
						{label}
					</a>
				</li>
			))
		}
	</nav>
	<div class="socials backdrop-blur-xl">
		{
			iconLinks.map(({ href, icon, label, color }) => (
				<Social href={href} icon={icon} label={label} color={color} />
			))
		}
	</div>
</header>

<style>
	header {
		z-index: 9999;
		position: fixed;
		width: 100%;
		font-family: var(--font-brand);
		font-weight: 500;
		margin-bottom: 3.5rem;
		display: grid;
		grid-template-columns: 1fr auto 1fr;
		align-items: center;
		padding: 2rem 3rem;
		gap: 1rem;
	}

	.site-logo {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		justify-self: flex-start;
	}

	.nav-items {
		margin: 0;
		display: flex;
		flex-direction: row;
		width: fit-content;
		justify-self: center;
		gap: 0.75rem;
		font-size: var(--text-md);
		line-height: 1.2;
		list-style: none;
		padding: 0.5rem 0.5625rem;
		font-size: var(--text-sm);
		border-radius: 999rem;
		box-shadow: var(--shadow-md);
		background: url('/assets/backgrounds/noise.png') top center/220px repeat;
		background-blend-mode: overlay;
		background-color: var(--gray-999_50);
	}

	.link {
		display: inline-block;
		color: var(--gray-300);
		text-decoration: none;
		padding: 0.5rem 1rem;
		border-radius: 999rem;
		transition:
			color var(--theme-transition),
			background-color var(--theme-transition);
	}

	.link:hover,
	.link:focus {
		color: var(--gray-100);
		background-color: var(--accent-subtle-overlay);
	}

	.link[aria-current='page'] {
		color: var(--accent-text-over);
		background-color: var(--accent-regular);
	}

	.link[aria-current] {
		color: var(--gray-0);
	}

	.socials {
		--icon-size: var(--text-xl);
		--icon-padding: 0.375rem;

		display: flex;
		flex-wrap: nowrap;
		font-size: var(--icon-size);
		justify-content: space-between;
		justify-self: flex-end;
		position: relative;
		flex-direction: row;
		border-radius: 999rem;
		padding: 0.4rem 0.6rem;
		box-shadow: var(--shadow-md);
		background-color: var(--gray-999_50);
	}

	@media (max-width: 45em) {
		header {
			grid-template-columns: auto;
			grid-template-rows: auto auto auto;
		}

		.site-logo {
			justify-self: center;
		}

		.socials {
			justify-self: center;
		}
	}
</style>
